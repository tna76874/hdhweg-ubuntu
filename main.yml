---
- hosts: localhost
  collections:
    - community.general

- name: Import local configs
  hosts: localhost
  become: yes
  tags:
    - always
  tasks:
    - name: Include vars file if present
      include_vars: "{{ item }}"
      with_first_found:
        - files:
            - vars.yml
            - /root/.config/vars_sysconfig.yml
          skip: true

- name: Packages to deploy as installation image
  hosts: localhost
  become: yes
  tags:
    - never
    - deploy
  roles:
    - base
    - deploy

- name: Repair system
  hosts: localhost
  become: yes
  tags: 
    - never
    - repair
  roles:
    - repair

- name: Maintenance script
  hosts: localhost
  become: yes
  tags:
    - base
    - setup
    - bigsetup
  roles:
    - base

- name: Initial setup and update routine
  hosts: localhost
  become: yes
  tags:
    - never
    - setup
    - bigsetup
  roles:
    - repair
    - base
    - setup
    - security

- name: Install Docker
  hosts: localhost
  become: yes
  tags:
    - never
    - docker
    - bigsetup
    - install_pihole
    - install_webcam
  roles:
    - docker

- name: Install mbz tool
  hosts: localhost
  become: yes
  tags: 
    - never
    - mbz
    - bigsetup
  roles:
    - mbz

- name: Deploy fritzbox tools
  hosts: localhost
  become: yes
  tags:
    - never
    - fritzbox
    - bigsetup
  roles:
    - fritzbox

- name: Install Webcam Tools
  hosts: localhost
  become: yes
  tags:
    - never
    - webcam
    - install_webcam
    - bigsetup
  roles:
    - webcam

- name: Install pihole
  hosts: localhost
  become: yes
  tags: 
    - never
    - pihole
    - install_pihole
    - uninstall_pihole
  roles:
    - pihole
